<!DOCTYPE html>
<html>
<head>
<title>New Post</title>

<meta name="viewport" content="width=device-width, initial-scale=1">

<style>

/* ===== RESET ===== */

*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

body{
    background:#f9f9f9;
}

/* ===== NAVBAR ===== */

.navbar{
    background:black;
    color:white;
    padding:18px 40px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}

.navbar button{
    background:white;
    color:black;
    border:none;
    padding:8px 16px;
    border-radius:20px;
    cursor:pointer;
}

/* ===== CONTAINER ===== */

.container{
    max-width:700px;
    margin:auto;
    padding:60px 20px;
}

/* Title */

h1{
    font-size:34px;
    margin-bottom:35px;
}

/* Inputs */

input, textarea{
    width:100%;
    padding:15px;
    border-radius:14px;
    border:1px solid #ddd;
    margin-bottom:20px;
    font-size:16px;
    outline:none;
    background:white;
}

textarea{
    height:180px;
    resize:none;
}

/* Button */

.primary-btn{
    padding:12px 26px;
    background:black;
    color:white;
    border:none;
    border-radius:26px;
    cursor:pointer;
    font-size:15px;
}

/* Error */

.error{
    color:red;
    margin-top:15px;
}

/* Responsive */

@media(max-width:600px){
    .navbar{
        padding:15px 20px;
    }

    .container{
        padding:40px 15px;
    }
}

</style>

</head>

<body>

<div class="navbar">
<div class="logo">Blog</div>

<div>
<button onclick="goHome()">Home</button>
<button onclick="logout()">Logout</button>
</div>
</div>

<div class="container">

<h1>Create New Post</h1>

<input type="text" id="title" placeholder="Post Title" />

<textarea id="content" placeholder="Write your content here..."></textarea>

<button class="primary-btn" onclick="createPost()">Publish</button>

<p id="error" class="error"></p>

</div>

<script>

const API_BASE="http://localhost:8080";

/* ===== AUTH ===== */

const token=localStorage.getItem("token");

if(!token){
    window.location.href="login.html";
}

function goHome(){
    window.location.href="index.html";
}

function logout(){
    localStorage.removeItem("token");
    window.location.href="login.html";
}

/* ===== CREATE POST ===== */

function createPost(){

    const title=document.getElementById("title").value.trim();
    const content=document.getElementById("content").value.trim();

    if(!title || !content){
        document.getElementById("error").innerText="All fields are required.";
        return;
    }

    fetch(`${API_BASE}/post`,{
        method:"POST",
        headers:{
            "Content-Type":"application/json",
            "Authorization":"Bearer "+token
        },
        body:JSON.stringify({
            title,
            content
        })
    })
    .then(res=>{
        if(!res.ok) throw new Error();
        return res.json();
    })
    .then(()=>{
        window.location.href="index.html";
    })
    .catch(()=>{
        document.getElementById("error").innerText="Error creating post.";
    });
}

</script>

</body>
</html>